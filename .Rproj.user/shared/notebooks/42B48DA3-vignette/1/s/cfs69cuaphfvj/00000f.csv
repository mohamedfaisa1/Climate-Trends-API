"0","# make station data on contigous USA"
"0","HI_inds <- which(station_data$state == ""HI"") # Hawaii indexes"
"0","AK_inds <- which(station_data$state == ""AK"") # Alaska indexes"
"0","joint_inds <- c(AK_inds, HI_inds)"
"0","contig_data <- station_data[-joint_inds,]"
"0",""
"0","# extract station data"
"0","stat_ids <- contig_data$station_id"
"0","stat_lons <- contig_data$LONGITUDE"
"0","stat_lats <- contig_data$LATITUDE"
"0","n <- length(stat_ids)"
"0",""
"0","# make average temperature vector & setup dates"
"0","avg_temps <- rep(NA, n)"
"0","start_d <- as.Date(""2024-03-01"")"
"0","end_d <- as.Date(""2024-03-31"")"
"0","for(i in 1:n){"
"0","  wbanno <- stat_ids[i]"
"0","  station <- extract_time_series_id(weather_data, wbanno, start_d, end_d)"
"0","  avg_temps[i] <- mean(station$T_DAILY_AVG, na.rm=T)"
"0","}"
"0",""
"0","# make data frame for temperature + spatial data"
"0","WD <- cbind.data.frame(lon=stat_lons, lat=stat_lats, avg_temp=avg_temps)"
"0","WD <- na.omit(WD) # remove NA"
"0",""
"0","# make spatial data frame"
"0","spat.df <- data.frame(x=WD$lon, y=WD$lat)"
"0",""
"0","# make response vector"
"0","Y <- WD$avg_temp"
"0",""
"0","# get elevation data for model"
"0","prj_code <- 4326 # projection code"
"0","el.mod <- elevatr::get_elev_point(spat.df, prj=prj_code, src=""aws"")"
"2",""
"2"," Accessing raster elevation [-------------------------]   0%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [-------------------------]   0%"
"2",""
"2"," Accessing raster elevation [>------------------------]   4%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [>------------------------]   4%"
"2",""
"2"," Accessing raster elevation [=>-----------------------]   8%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=>-----------------------]   8%"
"2",""
"2"," Accessing raster elevation [==>----------------------]  12%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==>----------------------]  12%"
"2",""
"2"," Accessing raster elevation [===>---------------------]  17%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===>---------------------]  17%"
"2",""
"2"," Accessing raster elevation [====>--------------------]  21%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [====>--------------------]  21%"
"2",""
"2"," Accessing raster elevation [=====>-------------------]  25%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=====>-------------------]  25%"
"2",""
"2"," Accessing raster elevation [======>------------------]  29%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [======>------------------]  29%"
"2",""
"2"," Accessing raster elevation [=======>-----------------]  33%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=======>-----------------]  33%"
"2",""
"2"," Accessing raster elevation [========>----------------]  38%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [========>----------------]  38%"
"2",""
"2"," Accessing raster elevation [=========>---------------]  42%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=========>---------------]  42%"
"2",""
"2"," Accessing raster elevation [==========>--------------]  46%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==========>--------------]  46%"
"2",""
"2"," Accessing raster elevation [===========>-------------]  50%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===========>-------------]  50%"
"2",""
"2"," Accessing raster elevation [=============>-----------]  54%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=============>-----------]  54%"
"2",""
"2"," Accessing raster elevation [==============>----------]  58%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==============>----------]  58%"
"2",""
"2"," Accessing raster elevation [===============>---------]  62%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===============>---------]  62%"
"2",""
"2"," Accessing raster elevation [================>--------]  67%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [================>--------]  67%"
"2",""
"2"," Accessing raster elevation [=================>-------]  71%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=================>-------]  71%"
"2",""
"2"," Accessing raster elevation [==================>------]  75%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==================>------]  75%"
"2",""
"2"," Accessing raster elevation [===================>-----]  79%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===================>-----]  79%"
"2",""
"2"," Accessing raster elevation [====================>----]  83%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [====================>----]  83%"
"2",""
"2"," Accessing raster elevation [=====================>---]  88%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=====================>---]  88%"
"2",""
"2"," Accessing raster elevation [======================>--]  92%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [======================>--]  92%"
"2",""
"2"," Accessing raster elevation [=======================>-]  96%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=======================>-]  96%"
"2",""
"2"," Accessing raster elevation [=========================] 100%"
"2","
"
"1",""
"2","Mosaicing & Projecting
"
"2","Note: Elevation units are in meters
"
"0","spat.df$elev <- el.mod$elevation"
"0",""
"0","# make design matrix for model"
"0","X_mod <- model.matrix(~1+x+y+elev, data=spat.df)"
"0",""
"0","# get grid points in contiguous USA + elevation data"
"0","g <- create_grid_points(resolution=100)"
"0","colnames(g) <- c(""x"", ""y"") # change lon to x and lat to y for elavatr"
"0","el.interp <- elevatr::get_elev_point(g, prj=prj_code, src=""aws"")"
"2",""
"2"," Accessing raster elevation [-------------------------]   0%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [-------------------------]   0%"
"2",""
"2"," Accessing raster elevation [>------------------------]   4%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [>------------------------]   4%"
"2",""
"2"," Accessing raster elevation [=>-----------------------]   8%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=>-----------------------]   8%"
"2",""
"2"," Accessing raster elevation [==>----------------------]  12%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==>----------------------]  12%"
"2",""
"2"," Accessing raster elevation [===>---------------------]  17%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===>---------------------]  17%"
"2",""
"2"," Accessing raster elevation [====>--------------------]  21%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [====>--------------------]  21%"
"2",""
"2"," Accessing raster elevation [=====>-------------------]  25%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=====>-------------------]  25%"
"2",""
"2"," Accessing raster elevation [======>------------------]  29%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [======>------------------]  29%"
"2",""
"2"," Accessing raster elevation [=======>-----------------]  33%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=======>-----------------]  33%"
"2",""
"2"," Accessing raster elevation [========>----------------]  38%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [========>----------------]  38%"
"2",""
"2"," Accessing raster elevation [=========>---------------]  42%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=========>---------------]  42%"
"2",""
"2"," Accessing raster elevation [==========>--------------]  46%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==========>--------------]  46%"
"2",""
"2"," Accessing raster elevation [===========>-------------]  50%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===========>-------------]  50%"
"2",""
"2"," Accessing raster elevation [=============>-----------]  54%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=============>-----------]  54%"
"2",""
"2"," Accessing raster elevation [==============>----------]  58%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==============>----------]  58%"
"2",""
"2"," Accessing raster elevation [===============>---------]  62%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===============>---------]  62%"
"2",""
"2"," Accessing raster elevation [================>--------]  67%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [================>--------]  67%"
"2",""
"2"," Accessing raster elevation [=================>-------]  71%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=================>-------]  71%"
"2",""
"2"," Accessing raster elevation [==================>------]  75%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [==================>------]  75%"
"2",""
"2"," Accessing raster elevation [===================>-----]  79%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [===================>-----]  79%"
"2",""
"2"," Accessing raster elevation [====================>----]  83%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [====================>----]  83%"
"2",""
"2"," Accessing raster elevation [=====================>---]  88%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=====================>---]  88%"
"2",""
"2"," Accessing raster elevation [======================>--]  92%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [======================>--]  92%"
"2",""
"2"," Accessing raster elevation [=======================>-]  96%"
"2","                                                            "
"2",""
"1",""
"2",""
"2"," Accessing raster elevation [=======================>-]  96%"
"2",""
"2"," Accessing raster elevation [=========================] 100%"
"2","
"
"1",""
"2","Mosaicing & Projecting
"
"2","Note: Elevation units are in meters
"
"0","g$elev <- el.interp$elevation"
"0",""
"0","# make design matrix for interpolations"
"0","X_interp <- model.matrix(~1+x+y+elev, data=g)"
"0",""
"0","# make interpolations"
"0","g <- g[,1:2]"
"0","interps <- interpolate_points(WD, Y, X_mod, g, X_interp)"
"1","Assuming columns 1 and 2 of locs are (longitude,latidue) in degrees
"
"0","# make title for plot & plot"
"0","t <- paste0(""Interpolated Average Temperature (°C)"", "
"0","      "" in the Mainland United States March 2024"")"
"0",""
"0","int.plot <- plot_gridded_interpolations(interps, g, t=t)"
"0",""
"0","# view plot"
"0","int.plot"
