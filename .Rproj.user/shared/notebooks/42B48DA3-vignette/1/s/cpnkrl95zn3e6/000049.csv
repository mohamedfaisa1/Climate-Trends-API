"0","# make station data on contigous USA"
"0","HI_inds <- which(station_data$state == ""HI"") # Hawaii indexes"
"0","AK_inds <- which(station_data$state == ""AK"") # Alaska indexes"
"0","joint_inds <- c(AK_inds, HI_inds)"
"0","contig_data <- station_data[-joint_inds,]"
"0",""
"0","# extract station data"
"0","stat_ids <- contig_data$station_id"
"0","stat_lons <- contig_data$LONGITUDE"
"0","stat_lats <- contig_data$LATITUDE"
"0","n <- length(stat_ids)"
"0",""
"0","# make warm and cold day vectors"
"0","warm <- rep(NA, n)"
"0","cold <- rep(NA, n)"
"0",""
"0","# get yearly cycles & population warm and cold vectors"
"0","for(i in 1:n){"
"0","  wbanno <- stat_ids[i]"
"0","  station <- estimate_yearly_cycle(weather_data, wbanno)"
"0","  warm[i] <- which.max(station[,2])"
"0","  cold[i] <- which.min(station[,2])"
"0","}"
"0",""
"0","# plot warm "
"0",""
"0","# make title for plot"
"0","t <- ""Warmest Days for Stations"""
"0",""
"0","# make plotting data frame"
"0","g <- cbind.data.frame(stat_lons, stat_lats)"
"0","colnames(g) <- c(""lon"", ""lat"")"
"0","contig_usa <- maps::map(""usa"", ""main"", exact=T, plot=F)"
"0","pts_poly <- sp::point.in.polygon(g$lon, g$lat, contig_usa$x, contig_usa$y)"
"0","keep <- which(pts_poly == 1)"
"0","img.mat <- cbind.data.frame(g, warm)"
"0","img.mat <- img.mat[keep, ]"
"0","img.mat <- na.omit(img.mat)"
"0","colnames(img.mat) <- c(""lon"", ""lat"", ""warm"")"
"0",""
"0","# get United States data"
"0","usm.img.mat <- usmap::usmap_transform(img.mat)"
"0",""
"0",""
"0","# plot data"
"0","usmap::plot_usmap(""states"", exclude=c(""AK"", ""HI"")) +"
"0","  ggplot2::geom_sf(data=usm.img.mat, ggplot2::aes(colour=warm)) +"
"0","  ggplot2::coord_sf() + ggplot2::ggtitle(t)+"
"0","  ggplot2::scale_color_gradient(low=""blue"", high=""red"","
"0","                                  name=""Day Number"") +"
"0","  ggplot2::theme(legend.title = ggplot2::element_text(hjust=0.5),"
"0","                 legend.position.inside=c(0.87,0.001), "
"0","                 plot.title=ggplot2::element_text(color=""black"", hjust=0.5,"
"0","                                                  size=15))"
